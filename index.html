<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>4班・3勤1休ローテ</title>

<style>
  :root{
    --bg1:#0b1020;
    --bg2:#121a33;
    --stroke:rgba(255,255,255,.12);
    --text:#f4f7ff;
    --muted:rgba(244,247,255,.68);

    --c1:#37d6ff;   /* 1番 */
    --c2:#a78bfa;   /* 2番 */
    --c3:#ff5ad6;   /* 3番 */
    --crest:#22c55e;/* 今日 */
    --hol:#ffb020;  /* 祝日 */
    --sun:#ff5a5a;
    --sat:#5aa9ff;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: system-ui, -apple-system, "Segoe UI", "Noto Sans JP", sans-serif;
    color:var(--text);
    background:
      radial-gradient(1100px 550px at 20% 15%, rgba(167,139,250,.35), transparent 60%),
      radial-gradient(900px 520px at 70% 20%, rgba(55,214,255,.28), transparent 60%),
      radial-gradient(900px 600px at 45% 85%, rgba(255,90,214,.20), transparent 60%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
    min-height:100vh;
  }

  .wrap{max-width:1100px;margin:0 auto;padding:18px 14px 26px;}
  .top{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;margin-bottom:14px;}
  .title{display:flex;flex-direction:column;gap:4px;}
  h1{margin:0;font-size:22px;letter-spacing:.02em;font-weight:900;}
  .sub{margin:0;font-size:13px;color:var(--muted);}

  .bar{
    display:flex;gap:10px;flex-wrap:wrap;align-items:center;
    background: rgba(255,255,255,.06);
    border:1px solid var(--stroke);
    border-radius: 16px;
    padding: 12px;
    backdrop-filter: blur(10px);
  }
  .bar .label{color:var(--muted);font-weight:800;font-size:13px}
  .btn{
    border:1px solid var(--stroke);
    background: rgba(15,23,48,.55);
    color:var(--text);
    padding:10px 12px;border-radius:12px;
    font-size:16px;font-weight:900;cursor:pointer;
    transition: transform .05s ease, background .15s ease;
  }
  .btn:hover{ background: rgba(15,23,48,.78); }
  .btn:active{ transform: translateY(1px); }
  .btn.primary{
    border-color: rgba(34,197,94,.55);
    box-shadow: 0 0 0 3px rgba(34,197,94,.10) inset;
  }
  .dateInput{
    border:1px solid var(--stroke);
    background: rgba(15,23,48,.55);
    color:var(--text);
    padding:10px 12px;border-radius:12px;
    font-size:16px;font-weight:900;
  }
  .spacer{flex:1}

  .dateHero{
    margin-top:14px;padding:18px 16px;border-radius:18px;
    background: rgba(255,255,255,.06);
    border: 1px solid var(--stroke);
    backdrop-filter: blur(10px);
    position: relative; overflow:hidden;
  }
  .dateHero::before{
    content:""; position:absolute; inset:-2px;
    background: linear-gradient(90deg, rgba(55,214,255,.25), rgba(167,139,250,.25), rgba(255,90,214,.22));
    filter: blur(18px); opacity:.8; pointer-events:none;
  }
  .dateHeroInner{position:relative;display:flex;flex-wrap:wrap;gap:12px;align-items:baseline;}
  .dateBig{font-size:44px;font-weight:1000;letter-spacing:.02em;}
  .dow{font-size:22px;font-weight:1000;color:var(--muted);}
  .badges{margin-left:auto;display:flex;gap:8px;align-items:center;flex-wrap:wrap;}
  .badge{
    padding:7px 12px;border-radius:999px;
    border:1px solid var(--stroke);
    font-weight:1000;font-size:13px;color:var(--muted);
    background: rgba(15,23,48,.55);
  }
  .badge.today{border-color: rgba(34,197,94,.55);color: var(--crest);background: rgba(34,197,94,.12);}
  .badge.holiday{border-color: rgba(255,176,32,.55);color: var(--hol);background: rgba(255,176,32,.14);}
  .badge.sun{border-color: rgba(255,90,90,.55);color: var(--sun);background: rgba(255,90,90,.14);}
  .badge.sat{border-color: rgba(90,169,255,.55);color: var(--sat);background: rgba(90,169,255,.14);}

  /* カードのみ（余計な帯は無し） */
  .grid{margin-top:14px;display:grid;grid-template-columns: repeat(2, minmax(0, 1fr));gap:12px;}
  @media (max-width: 860px){
    .grid{grid-template-columns:1fr;}
    .dateBig{font-size:38px;}
  }

  .card{
    border-radius:20px;border:1px solid var(--stroke);
    background: rgba(255,255,255,.06);
    backdrop-filter: blur(10px);
    padding:16px; position: relative; overflow:hidden;
    box-shadow: 0 14px 40px rgba(0,0,0,.28);
  }
  .card::before{content:"";position:absolute;inset:-2px;opacity:.55;filter: blur(18px);pointer-events:none;}
  .cardHeader{position:relative;display:flex;align-items:baseline;gap:10px;margin-bottom:10px;}
  .group{font-size:22px;font-weight:1100;letter-spacing:.02em;}
  .groupSmall{color: var(--muted);font-size:12px;font-weight:900;margin-left:auto;}
  .mainRow{position:relative;display:flex;align-items:flex-end;gap:12px;}
  .bigPos{font-size:64px;font-weight:1200;line-height:.95;letter-spacing:.02em;}
  .bigPos span{font-size:24px;font-weight:1100;margin-left:4px;color:var(--muted);}
  .timeSmall{font-size:16px;font-weight:900;color:var(--muted);padding-bottom:6px;}

  .pos1::before{background: radial-gradient(700px 260px at 20% 20%, rgba(55,214,255,.55), transparent 60%);}
  .pos2::before{background: radial-gradient(700px 260px at 20% 20%, rgba(167,139,250,.55), transparent 60%);}
  .pos3::before{background: radial-gradient(700px 260px at 20% 20%, rgba(255,90,214,.50), transparent 60%);}
  .posR::before{background: radial-gradient(700px 260px at 20% 20%, rgba(34,197,94,.35), transparent 60%);}

  .pos1 .bigPos{color: var(--c1);text-shadow:0 0 24px rgba(55,214,255,.20);}
  .pos2 .bigPos{color: var(--c2);text-shadow:0 0 24px rgba(167,139,250,.20);}
  .pos3 .bigPos{color: var(--c3);text-shadow:0 0 24px rgba(255,90,214,.20);}
  .posR .bigPos{color: var(--crest);text-shadow:0 0 24px rgba(34,197,94,.18);}
</style>
</head>

<body>
<div class="wrap">
  <div class="top">
    <div class="title">
      <h1>4班・3勤1休ローテ（三交代）</h1>
      <p class="sub">カードを見れば「Aが何番か」一発で分かる</p>
    </div>
  </div>

  <div class="bar">
    <span class="label">日付</span>

    <!-- 並び：←7日、←1日、今日、1日→、7日→ -->
    <button class="btn" id="prev7">← 7日</button>
    <button class="btn" id="prev1">← 1日</button>
    <button class="btn primary" id="today">今日</button>
    <button class="btn" id="next1">1日 →</button>
    <button class="btn" id="next7">7日 →</button>

    <span class="spacer"></span>

    <span class="label">指定日</span>
    <input class="dateInput" type="date" id="picker">
  </div>

  <div class="dateHero">
    <div class="dateHeroInner" id="hero"></div>
  </div>

  <!-- サマリー帯は削除。カードだけ。 -->
  <div class="grid" id="cards"></div>
</div>

<script>
/* ===== 日付（ローカル固定：表示上の説明は出さない） ===== */
function ymdLocal(d){
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,'0');
  const day = String(d.getDate()).padStart(2,'0');
  return `${y}-${m}-${day}`;
}
function parseYMDLocal(s){
  const [y,m,d] = s.split('-').map(Number);
  return new Date(y, m-1, d);
}
function addDays(d, n){
  return new Date(d.getFullYear(), d.getMonth(), d.getDate() + n);
}
function diffDays(a,b){
  const A = new Date(a.getFullYear(), a.getMonth(), a.getDate(), 12);
  const B = new Date(b.getFullYear(), b.getMonth(), b.getDate(), 12);
  return Math.round((A - B) / 86400000);
}
function mod(n, m){ return ((n % m) + m) % m; }

/* ===== 祝日（必要なら差し替え。表示はバッジのみ） ===== */
const HOLIDAYS = [
  // 例：必要に応じて追加
  "2026-02-11",
  "2026-02-23",
  "2026-03-20"
];
const holidaySet = new Set(HOLIDAYS);
function isHoliday(d){ return holidaySet.has(ymdLocal(d)); }

/* ===== ローテ（基準：2026-02-02 で 1番=B 2番=A 3番=D 休=C） [1](https://ubeglobal-my.sharepoint.com/personal/32607u_ube_com/Documents/Whiteboards/Microsoft%20Copilot%20%E3%83%81%E3%83%A3%E3%83%83%E3%83%88%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB/%E3%81%84%E3%81%A1%E3%81%AB%E3%81%A1%E3%81%9A%E3%82%8C.txt) ===== */
const baseDate = parseYMDLocal("2026-02-02"); // [1](https://ubeglobal-my.sharepoint.com/personal/32607u_ube_com/Documents/Whiteboards/Microsoft%20Copilot%20%E3%83%81%E3%83%A3%E3%83%83%E3%83%88%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB/%E3%81%84%E3%81%A1%E3%81%AB%E3%81%A1%E3%81%9A%E3%82%8C.txt)
const cycle = ["1","1","1","休","3","3","3","休","2","2","2","休"]; // [1](https://ubeglobal-my.sharepoint.com/personal/32607u_ube_com/Documents/Whiteboards/Microsoft%20Copilot%20%E3%83%81%E3%83%A3%E3%83%83%E3%83%88%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB/%E3%81%84%E3%81%A1%E3%81%AB%E3%81%A1%E3%81%9A%E3%82%8C.txt)

/* 地獄回避の開始位置（同時休み多発を防ぐ） */
const baseIndexByGroup = {
  "B": 0,  // 1番
  "A": 9,  // 2番
  "D": 6,  // 3番
  "C": 3   // 休
};

const timeByShift = {
  "1":"08:00–16:00",
  "2":"16:00–23:00",
  "3":"23:00–08:00",
  "休":"（休み）"
};

function groupToShiftAt(date){
  const dd = diffDays(date, baseDate);
  const g2s = {};
  for(const g of ["A","B","C","D"]){
    const idx = mod(baseIndexByGroup[g] + dd, cycle.length);
    g2s[g] = cycle[idx];
  }
  return g2s;
}

/* ===== UI ===== */
const dowJP = ["日","月","火","水","木","金","土"];
let current = new Date();

const picker  = document.getElementById("picker");
const hero    = document.getElementById("hero");
const cards   = document.getElementById("cards");

function dayBadge(d){
  if(isHoliday(d)) return {text:"祝日", cls:"holiday"};
  const w = d.getDay();
  if(w === 0) return {text:"日", cls:"sun"};
  if(w === 6) return {text:"土", cls:"sat"};
  return null;
}
function posClass(s){
  if(s === "1") return "pos1";
  if(s === "2") return "pos2";
  if(s === "3") return "pos3";
  return "posR";
}
function render(){
  const ymd = ymdLocal(current);
  picker.value = ymd;

  const isToday = (ymdLocal(new Date()) === ymd);
  const badge = dayBadge(current);
  const g2s = groupToShiftAt(current);

  const b1 = isToday ? `<span class="badge today">今日</span>` : ``;
  const b2 = badge ? `<span class="badge ${badge.cls}">${badge.text}</span>` : ``;

  hero.innerHTML = `
    <div class="dateBig">${ymd}</div>
    <div class="dow">（${dowJP[current.getDay()]}）</div>
    <div class="badges">${b1}${b2}</div>
  `;

  cards.innerHTML = ["A","B","C","D"].map(g=>{
    const s = g2s[g];
    const cls = posClass(s);
    const time = timeByShift[s];
    const num = (s==="休") ? "休" : s;
    const suffix = (s==="休") ? "" : `<span>番</span>`;
    const small = (s==="休") ? "休み" : `${s}番（${time}）`;
    const timeLabel = (s==="休") ? "休み" : time;
    return `
      <div class="card ${cls}">
        <div class="cardHeader">
          <div class="group">${g}班</div>
          <div class="groupSmall">${small}</div>
        </div>
        <div class="mainRow">
          <div class="bigPos">${num}${suffix}</div>
          <div class="timeSmall">${timeLabel}</div>
        </div>
      </div>
    `;
  }).join("");
}

/* 操作 */
document.getElementById("today").onclick = ()=>{ current = new Date(); render(); };
document.getElementById("prev1").onclick = ()=>{ current = addDays(current, -1); render(); };
document.getElementById("next1").onclick = ()=>{ current = addDays(current, +1); render(); };
document.getElementById("prev7").onclick = ()=>{ current = addDays(current, -7); render(); };
document.getElementById("next7").onclick = ()=>{ current = addDays(current, +7); render(); };
picker.onchange = ()=>{ if(picker.value){ current = parseYMDLocal(picker.value); render(); } };

render();
</script>
</body>
</html>
